<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åœ˜éšŠè§’è‰²èˆ‡å”ä½œæ½›åŠ›åˆ†æå ±å‘Š - å„ªå‹¢å¤©è³¦è©•æ¸¬ç³»çµ±</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --mckinsey-navy: #001F3F;
            --mckinsey-deep-blue: #003D73;
            --mckinsey-blue: #0066A6;
            --mckinsey-bright-blue: #0080D9;
            --mckinsey-light-blue: #E6F2FF;
            --consultant-gold: #D4AF37;
            --insight-teal: #008080;
            --data-orange: #FF6B35;
            --success-green: #2D8659;
            --alert-red: #C1272D;
            --gray-900: #1A1A1A;
            --gray-800: #333333;
            --gray-700: #4D4D4D;
            --gray-600: #666666;
            --gray-500: #7A7A7A;
            --gray-400: #999999;
            --gray-300: #CCCCCC;
            --gray-200: #E5E5E5;
            --gray-100: #F2F2F2;
            --gray-50: #F8F8F8;
            --white: #FFFFFF;
            --radius-sm: 2px;
            --radius-md: 4px;
            --radius-lg: 8px;
            --radius-full: 9999px;
            --border-thin: 1px;
            --border-medium: 2px;
            --border-thick: 3px;
            --executing: #7C3AED;
            --influencing: #F59E0B;
            --relationship: #0EA5E9;
            --strategic: #10B981;
        }

        body {
            margin: 0;
            background: var(--gray-50);
            color: var(--gray-900);
            font-family: "Noto Sans TC", "Microsoft JhengHei", system-ui, -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, "Helvetica Neue", Arial, sans-serif;
            line-height: 1.6;
        }

        /* å°èˆªæ¬„ */
        .navbar {
            background: var(--white);
            padding: 1rem 0;
            box-shadow: 0 2px 12px rgba(0, 31, 63, 0.06);
            position: sticky;
            top: 0;
            z-index: 1000;
            border-bottom: 1px solid var(--gray-200);
        }

        .nav-container {
            max-width: 1280px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 24px;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--mckinsey-navy);
            cursor: pointer;
            text-decoration: none;
        }

        .logo::before {
            content: "ğŸ‘¥";
            font-size: 1.5rem;
        }

        .nav-actions {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .nav-btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            border-radius: var(--radius-md);
            border: var(--border-medium) solid var(--mckinsey-blue);
            background: transparent;
            color: var(--mckinsey-blue);
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 0.85rem;
            font-weight: 600;
        }

        .nav-btn:hover {
            background: var(--mckinsey-light-blue);
            border-color: var(--mckinsey-deep-blue);
        }

        .nav-btn.primary {
            background: var(--mckinsey-blue);
            color: #fff;
            border-color: var(--mckinsey-blue);
        }

        .nav-btn.primary:hover {
            background: var(--mckinsey-deep-blue);
        }

        /* ä¸»å®¹å™¨ */
        .main-container {
            max-width: 1280px;
            margin: 40px auto;
            padding: 0 24px;
        }
        
        .page-header {
            text-align: center;
            margin-bottom: 32px;
            background: var(--white);
            border: var(--border-thin) solid var(--gray-200);
            border-bottom: var(--border-medium) solid var(--mckinsey-navy);
            border-radius: var(--radius-md);
            padding: 32px;
        }

        .page-header h1 {
            font-size: 28px;
            color: var(--mckinsey-navy);
            margin-bottom: 12px;
        }

        .page-header p {
            font-size: 16px;
            color: var(--gray-600);
            max-width: 720px;
            margin: 0 auto;
        }

        .content-grid {
            display: grid;
            grid-template-columns: repeat(12, 1fr);
            gap: 32px;
        }
        
        .main-content {
            grid-column: span 12 / span 12;
        }
        
        @media (min-width: 1024px) {
            .main-content {
                grid-column: span 8 / span 8;
            }
            .sidebar {
                grid-column: span 4 / span 4;
            }
        }

        .analysis-card {
            background: var(--white);
            border: var(--border-thin) solid var(--gray-200);
            border-radius: var(--radius-md);
            padding: 28px;
            margin-bottom: 32px;
        }
 
         .analysis-card::before {
            content: "";
            position: absolute;
             inset: 0;
             background: var(--gradient-card);
             opacity: 0.9;
             pointer-events: none;
            z-index: 0;
         }
 
         .analysis-card::after {
            content: "";
            position: absolute;
             top: -60px;
             right: -40px;
             width: 200px;
             height: 200px;
             background: rgba(11, 154, 165, 0.12);
             filter: blur(0);
            border-radius: 50%;
             pointer-events: none;
            z-index: 0;
        }

        .analysis-card > * {
            position: relative;
            z-index: 1;
        }

        .card-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--gray-200);
        }
 
        .card-icon {
            width: 48px;
            height: 48px;
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: #fff;
            background: var(--mckinsey-blue);
        }
 
        .card-title {
            font-size: 20px;
            font-weight: 600;
            color: var(--mckinsey-navy);
        }
 
        .card-subtitle {
            font-size: 14px;
            color: var(--gray-600);
        }

        .badge-pill {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.375rem 0.9rem;
            border-radius: 999px;
            background: var(--mckinsey-light-blue);
            color: var(--mckinsey-blue);
            font-size: 0.7rem;
            letter-spacing: 0.12em;
            text-transform: uppercase;
            font-weight: 600;
        }
 
        .badge-pill.gold {
            background: rgba(212, 175, 55, 0.18);
            color: var(--consultant-gold);
        }
 
        .badge-pill.neutral {
            background: rgba(153, 153, 153, 0.15);
            color: var(--gray-600);
        }

        .section-footnote {
            margin-top: 1.25rem;
            font-size: 0.8125rem;
            color: var(--gray-600);
            display: flex;
            align-items: flex-start;
            gap: 0.5rem;
        }

        .section-footnote::before {
            content: "â„¹";
            font-weight: 600;
            color: var(--mckinsey-blue);
            font-size: 0.9rem;
        }

        /* åœ˜éšŠè§’è‰²ç¾…ç›¤ */
        #team-compass-card {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 2rem;
            position: relative;
        }

        @media (min-width: 768px) {
            #team-compass-card {
                flex-direction: row;
            }
        }
 
        .compass-chart-container {
            position: relative;
            width: 100%;
            height: auto;
            flex-shrink: 1;
            border-radius: 0;
            background: transparent;
            border: none;
            box-shadow: none;
        }

        .compass-chart-container svg {
            width: 100%;
            height: 100%;
        }

        .compass-description {
            flex-grow: 1;
            position: relative;
        }

        .compass-description h3 {
            font-size: 20px;
            margin-bottom: 12px;
            color: var(--mckinsey-navy);
        }
 
        .compass-description p {
            margin-bottom: 12px;
            color: var(--gray-600);
        }

        /* åŸå‹å„€è¡¨æ¿ */
        .archetype-dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
        }
 
        .info-item {
            background: var(--white);
            border-radius: var(--radius-md);
            padding: 24px;
            border: var(--border-thin) solid var(--gray-200);
            border-left: 4px solid;
            box-shadow: 0 10px 24px rgba(0, 31, 63, 0.08);
        }
 
        .info-item h4 {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 1rem;
            margin-bottom: 0.75rem;
            color: var(--mckinsey-navy);
            letter-spacing: 0.02em;
        }
 
        .info-item p {
            font-size: 0.875rem;
            color: var(--gray-600);
            line-height: 1.5;
        }

        /* ç†æƒ³åœ˜éšŠçµ„åˆ */
        .team-composition {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1.5rem;
        }
         
        @media (min-width: 768px) {
            .team-composition {
                grid-template-columns: repeat(3, 1fr);
            }
        }
 
        .team-member-card {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            background: var(--white);
            border: var(--border-thin) solid var(--gray-200);
            border-radius: var(--radius-md);
            padding: 24px;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            box-shadow: 0 10px 24px rgba(0, 31, 63, 0.08);
        }
         
        .team-member-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 18px 32px rgba(0, 31, 63, 0.12);
        }
 
        .member-icon {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            margin-bottom: 1rem;
            color: #fff;
            box-shadow: 0 8px 16px rgba(0, 31, 63, 0.12);
        }
 
        .team-member-card h4 {
            font-size: 1.125rem;
            margin-bottom: 0.5rem;
            color: var(--mckinsey-navy);
            letter-spacing: 0.02em;
        }
 
        .team-member-card p {
            font-size: 0.875rem;
            color: var(--gray-600);
        }

        /* åœ˜éšŠé©é…æ€§é³¥ç°è¡¨ */
        .matrix-grid {
            display: grid;
            gap: 24px;
        }

        .matrix-block {
            background: var(--white);
            border: var(--border-thin) solid var(--gray-200);
            border-radius: var(--radius-md);
            padding: 28px;
            display: grid;
            gap: 18px;
            box-shadow: 0 12px 26px rgba(0, 31, 63, 0.08);
        }

        .matrix-stage {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .matrix-stage-number {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: var(--mckinsey-blue);
            color: #fff;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 16px;
        }

        .matrix-stage-pill {
            display: inline-flex;
            align-items: center;
            padding: 4px 12px;
            font-size: 11px;
            font-weight: 600;
            letter-spacing: 0.12em;
            text-transform: uppercase;
            border-radius: 999px;
            background: var(--mckinsey-light-blue);
            color: var(--mckinsey-blue);
        }

        .matrix-heading {
            margin: 0;
            font-size: 20px;
            font-weight: 600;
            color: var(--mckinsey-navy);
            letter-spacing: 0.02em;
        }

        .matrix-subtitle {
            margin: 0;
            font-size: 14px;
            color: var(--gray-600);
        }

        .matrix-columns {
            display: grid;
            grid-template-columns: repeat(2, minmax(0, 1fr));
            gap: 1.1rem;
        }

        .matrix-card {
            border-radius: var(--radius-md);
            padding: 16px;
            border: var(--border-thin) solid var(--gray-200);
            background: var(--white);
            box-shadow: 0 6px 16px rgba(0, 31, 63, 0.06);
            display: grid;
            gap: 10px;
        }

        .matrix-card.challenge {
            background: rgba(255, 235, 235, 0.7);
            border-color: rgba(193, 39, 45, 0.2);
        }

        .matrix-card h6 {
            margin: 0;
            font-size: 14px;
            font-weight: 600;
            color: var(--mckinsey-navy);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .matrix-card.challenge h6 {
            color: var(--alert-red);
        }

        .matrix-card p {
            margin: 0;
            font-size: 13px;
            color: var(--gray-600);
            line-height: 1.55;
        }

        .matrix-chip {
            display: inline-flex;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            align-items: center;
            justify-content: center;
            background: rgba(45, 134, 89, 0.2);
            color: var(--success-green);
            font-size: 0.95rem;
        }

        .matrix-card.challenge .matrix-chip {
            background: rgba(193, 39, 45, 0.2);
            color: var(--alert-red);
        }

        @media (max-width: 768px) {
            .matrix-columns {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 640px) {
            .matrix-block {
                padding: 24px;
            }
        }

        /* å´é‚Šæ¬„ */
        .sidebar {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .sidebar-card {
            background: var(--white);
            border: var(--border-thin) solid var(--gray-200);
            border-radius: var(--radius-md);
            padding: 24px;
            box-shadow: 0 10px 24px rgba(0, 31, 63, 0.08);
        }

        .sidebar-title {
            font-size: 1.125rem;
            font-weight: 600;
            margin-bottom: 1.25rem;
            color: var(--mckinsey-navy);
            letter-spacing: 0.02em;
        }
        
        .domain-scores-list {
            list-style: none;
            margin: 0;
            padding: 0;
            display: grid;
            gap: 1rem;
        }

        .domain-scores-list li {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.875rem;
            padding: 0.5rem 0;
        }
        
        .domain-name {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-weight: 500;
            color: var(--gray-600);
        }
        
        .domain-color-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
        }
        
        .domain-bar-container {
            flex-grow: 1;
            height: 10px;
            background: rgba(148, 163, 184, 0.12);
            border-radius: 999px;
            margin: 0 1rem;
            overflow: hidden;
        }
        
        .domain-bar {
            height: 100%;
            border-radius: 999px;
            transition: width 1s ease-in-out;
            box-shadow: 0 4px 8px rgba(0, 31, 63, 0.12);
        }
        
        .domain-percentage {
            font-weight: 600;
            width: 40px;
            text-align: right;
            color: var(--mckinsey-navy);
        }

        .action-buttons {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin-top: 1.5rem;
        }

        .action-btn {
            width: 100%;
            padding: 0.9rem 1rem;
            border-radius: 0.75rem;
            border: 1px solid rgba(15, 79, 140, 0.22);
            font-weight: 500;
            cursor: pointer;
            transition: transform 0.2s ease, box-shadow 0.2s ease, background 0.2s ease;
            background: rgba(255, 255, 255, 0.9);
            color: var(--gray-700);
            letter-spacing: 0.02em;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            font-size: 14px;
        }

        .action-btn.primary {
            background: var(--mckinsey-blue);
            color: #fff;
            border: none;
            box-shadow: 0 10px 20px rgba(0, 102, 166, 0.18);
        }

        .action-btn.primary:hover {
            background: var(--mckinsey-deep-blue);
        }

        .action-btn.secondary {
            background: var(--white);
            color: var(--mckinsey-blue);
            border-color: var(--mckinsey-blue);
        }

        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 16px 24px rgba(0, 27, 46, 0.16);
        }

        /* éŸ¿æ‡‰å¼ */
        @media (max-width: 640px) {
            .nav-container {
                flex-direction: column;
                gap: 1rem;
            }
            .page-header h1 {
                font-size: 1.75rem;
            }
        }

        /* è¼‰å…¥å‹•ç•« */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .fade-in {
            animation: fadeIn 0.8s ease-out forwards;
            opacity: 0;
        }
        
        .fade-in.delay-1 { animation-delay: 0.1s; }
        .fade-in.delay-2 { animation-delay: 0.2s; }
        .fade-in.delay-3 { animation-delay: 0.3s; }
        .fade-in.delay-4 { animation-delay: 0.4s; }

        /* æ‰“å°æ¨£å¼ */
        @media print {
            .navbar, .sidebar, .action-buttons { display: none; }
            .content-grid { grid-template-columns: 1fr; }
            .analysis-card { box-shadow: none; border: 1px solid #ccc; }
        }

        .archetype-cards-grid {
            display: grid;
            grid-template-columns: repeat(2, minmax(0, 1fr));
            gap: 16px;
        }

        @media (max-width: 640px) {
            .archetype-cards-grid {
                grid-template-columns: 1fr;
            }
        }

        .archetype-card {
            background: var(--white);
            border: 2px solid var(--gray-200);
            border-radius: 12px;
            padding: 20px;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            position: relative;
            box-shadow: 0 10px 20px rgba(0, 31, 63, 0.08);
        }

        .archetype-card.primary {
            border-color: var(--mckinsey-blue);
            box-shadow: 0 16px 28px rgba(0, 102, 166, 0.16);
        }

        .archetype-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 18px 32px rgba(0, 31, 63, 0.12);
        }

        .archetype-card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .archetype-card-icon {
            width: 44px;
            height: 44px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            box-shadow: 0 6px 14px rgba(0, 31, 63, 0.12);
            color: #fff;
        }

        .archetype-card-score {
            font-size: 1.6rem;
            font-weight: 700;
        }

        .archetype-card-title {
            font-size: 1rem;
            font-weight: 600;
            color: var(--mckinsey-navy);
            margin: 0 0 8px;
        }

        .archetype-card-bar {
            height: 8px;
            background: rgba(0, 31, 63, 0.08);
            border-radius: 999px;
            overflow: hidden;
            margin: 8px 0;
        }

        .archetype-card-bar-fill {
            height: 100%;
            border-radius: 999px;
        }

        .archetype-card-desc {
            font-size: 0.82rem;
            color: var(--gray-600);
            margin: 0;
        }

        .archetype-card-badge {
            position: absolute;
            top: -10px;
            right: 12px;
            background: linear-gradient(135deg, var(--consultant-gold), #F4E4B0);
            color: var(--gray-900);
            font-size: 0.7rem;
            font-weight: 700;
            padding: 4px 12px;
            border-radius: 999px;
            box-shadow: 0 6px 12px rgba(212, 175, 55, 0.3);
        }
    </style>
</head>
<body>
    <!-- å°èˆªæ¬„ -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="logo" onclick="backToResults()">
                â† è¿”å›å€‹äººå„ªå‹¢å ±å‘Š
            </div>
            <div class="nav-actions">
                <button class="nav-btn" onclick="window.print()">
                    ğŸ“„ ä¸‹è¼‰PDF
                </button>
                <button class="nav-btn primary" onclick="shareReport()">ğŸ“¤ åˆ†äº«</button>
            </div>
        </div>
    </nav>

    <!-- ä¸»å®¹å™¨ -->
    <div class="main-container">
        <header class="page-header fade-in">
            <h1>åœ˜éšŠè§’è‰²èˆ‡å”ä½œæ½›åŠ›åˆ†æå ±å‘Š</h1>
            <p>æœ¬å ±å‘ŠåŸºæ–¼æ‚¨çš„æ‰å¹¹çµ„åˆï¼Œåˆ†ææ‚¨åœ¨åœ˜éšŠä¸­çš„æ ¸å¿ƒè§’è‰²ã€å”ä½œé¢¨æ ¼èˆ‡æ½›åŠ›ï¼Œä¸¦æä¾›æ§‹å»ºé«˜æ•ˆèƒ½åœ˜éšŠçš„å»ºè­°ã€‚</p>
        </header>
        
        <div class="content-grid">
            <!-- å·¦å´ä¸»å…§å®¹ -->
            <div class="main-content">
                <!-- åœ˜éšŠè§’è‰²ç¾…ç›¤ -->
                <div id="team-compass-card" class="analysis-card fade-in delay-1">
                    <div class="compass-chart-container" id="compass-chart">
                        <!-- SVG é›·é”åœ–å°‡åœ¨æ­¤ç”Ÿæˆ -->
                    </div>
                    <div class="compass-description" id="compass-main-archetype">
                        <span class="badge-pill gold">Team Compass</span>
                        <h3>æ­£åœ¨åˆ†ææ‚¨çš„åœ˜éšŠè§’è‰²...</h3>
                        <p>æˆ‘å€‘å°‡æ ¹æ“šæ‚¨çš„æ‰å¹¹çµ„åˆï¼Œç¢ºå®šæ‚¨åœ¨åœ˜éšŠä¸­çš„æ ¸å¿ƒåŸå‹å®šä½ã€‚</p>
                        </div>
                    </div>

                <!-- æ‚¨çš„åŸå‹å„€è¡¨æ¿ -->
                <div class="analysis-card fade-in delay-2">
                    <div class="card-header">
                        <div class="card-icon" id="archetype-icon">ğŸ‘¤</div>
                        <div>
                            <h2 class="card-title" id="archetype-title">åˆ†æä¸­...</h2>
                            <p class="card-subtitle" id="archetype-subtitle">æ­£åœ¨è¨ˆç®—æ‚¨çš„æ ¸å¿ƒåœ˜éšŠè²¢ç»</p>
                        </div>
                        </div>
                    <div class="archetype-dashboard" id="archetype-dashboard-content">
                        <!-- å‹•æ…‹ç”Ÿæˆå„€è¡¨æ¿é …ç›® -->
                         <div class="info-item" style="border-color: var(--neutral-200);">
                            <h4>â³ æ ¸å¿ƒè²¢ç»</h4>
                            <p>æ­£åœ¨åˆ†æ...</p>
                    </div>
                         <div class="info-item" style="border-color: var(--neutral-200);">
                            <h4>â³ å”ä½œé¢¨æ ¼</h4>
                            <p>æ­£åœ¨åˆ†æ...</p>
                </div>
                         <div class="info-item" style="border-color: var(--neutral-200);">
                            <h4>â³ æ½›åœ¨ç›²é»</h4>
                            <p>æ­£åœ¨åˆ†æ...</p>
                    </div>
                                </div>
                        </div>

                <!-- ç†æƒ³åœ˜éšŠçµ„åˆ -->
                <div class="analysis-card fade-in delay-3">
                    <div class="card-header">
                        <div class="card-icon" style="background: var(--neutral-900);">ğŸ¤</div>
                        <div>
                            <h2 class="card-title">ç†æƒ³åœ˜éšŠçµ„åˆå»ºè­°</h2>
                            <p class="card-subtitle">åœç¹æ‚¨çš„å„ªå‹¢ï¼Œæ§‹å»ºä¸€æ”¯é«˜æ•ˆèƒ½çš„å¤¢å¹»åœ˜éšŠ</p>
                                </div>
                            </div>
                    <div class="team-composition" id="team-composition-content">
                        <!-- å‹•æ…‹ç”Ÿæˆäº’è£œéšŠå‹å¡ç‰‡ -->
                        <p>æ­£åœ¨ç‚ºæ‚¨å°‹æ‰¾æœ€ä½³éšŠå‹...</p>
                        </div>
                    <div class="section-footnote">å»ºè­°è‡³å°‘æ­é… 2 å€‹äº’è£œåŸå‹ï¼Œä»¥ç¶­æŒç­–ç•¥ã€åŸ·è¡Œã€å½±éŸ¿ã€é—œä¿‚å››è±¡é™çš„å¹³è¡¡ã€‚</div>
                        </div>

                <!-- åœ˜éšŠé©é…æ€§é³¥ç°è¡¨ -->
                <div class="analysis-card fade-in delay-4">
                    <div class="card-header">
                        <div class="card-icon" style="background: #4A5568;">ğŸ“ˆ</div>
                            <div>
                            <h2 class="card-title">åœ˜éšŠé©é…æ€§é³¥ç°è¡¨</h2>
                            <p class="card-subtitle">æ‚¨åœ¨åœ˜éšŠç™¼å±•ä¸åŒéšæ®µçš„è§’è‰²èˆ‡è²¢ç»</p>
                                </div>
                            </div>
                    <div id="team-fitness-matrix-content">
                        <p>æ­£åœ¨ç”Ÿæˆæ‚¨çš„åœ˜éšŠé©é…æ€§åˆ†æ...</p>
                        </div>
                    </div>
                </div>

            <!-- å³å´å´é‚Šæ¬„ -->
            <aside class="sidebar">
                <div class="sidebar-card fade-in delay-4">
                    <h4 class="sidebar-title">å››å¤§æ‰å¹¹é ˜åŸŸè²¢ç»åº¦</h4>
                    <ul class="domain-scores-list" id="domain-scores">
                        <!-- å‹•æ…‹ç”Ÿæˆé ˜åŸŸåˆ†æ•¸æ¢ -->
                    </ul>
        </div>

                <div class="sidebar-card fade-in delay-4">
                    <h4 class="sidebar-title">ä¸‹ä¸€æ­¥è¡Œå‹•</h4>
                    <div class="action-buttons">
                        <button class="action-btn primary" onclick="backToResults()">
                            â† è¿”å›å€‹äººå„ªå‹¢å ±å‘Š
            </button>
                        <button class="action-btn secondary" onclick="window.location.href='landing.html'">
                            ğŸ  è¿”å›é¦–é 
                        </button>
                        <button class="action-btn secondary" onclick="window.location.href='assessment-intro.html'">
                            ğŸ”„ é‡æ–°è©•æ¸¬
            </button>
                    </div>
                </div>
            </aside>
        </div>
    </div>

    <script>
        // API Configuration
        const apiBase = window.location.port === '8005' ? '' : `http://${window.location.hostname}:8005`;

        // æ‰å¹¹å®šç¾©
        const TALENT_DEFINITIONS = {
            "T1": { name: "çµæ§‹åŒ–åŸ·è¡Œ", domain: "EXECUTING", icon: "ğŸ¯", dimension: "structured_execution" },
            "T2": { name: "å“è³ªèˆ‡å®Œå‚™", domain: "EXECUTING", icon: "âœ…", dimension: "quality_perfectionism" },
            "T3": { name: "æ¢ç´¢èˆ‡å‰µæ–°", domain: "STRATEGIC_THINKING", icon: "ğŸ”", dimension: "exploration_innovation" },
            "T4": { name: "åˆ†æèˆ‡æ´å¯Ÿ", domain: "STRATEGIC_THINKING", icon: "ğŸ“Š", dimension: "analytical_insight" },
            "T5": { name: "å½±éŸ¿èˆ‡å€¡è­°", domain: "INFLUENCING", icon: "ğŸ’ª", dimension: "influence_advocacy" },
            "T6": { name: "å”ä½œèˆ‡å…±å¥½", domain: "RELATIONSHIP_BUILDING", icon: "ğŸ¤", dimension: "collaboration_harmony" },
            "T7": { name: "å®¢æˆ¶å°å‘", domain: "INFLUENCING", icon: "ğŸ¯", dimension: "customer_orientation" },
            "T8": { name: "å­¸ç¿’èˆ‡æˆé•·", domain: "STRATEGIC_THINKING", icon: "ğŸ“š", dimension: "learning_growth" },
            "T9": { name: "ç´€å¾‹èˆ‡ä¿¡ä»»", domain: "RELATIONSHIP_BUILDING", icon: "âš–ï¸", dimension: "discipline_trust" },
            "T10": { name: "å£“åŠ›èª¿ç¯€", domain: "RELATIONSHIP_BUILDING", icon: "ğŸ§˜", dimension: "pressure_regulation" },
            "T11": { name: "è¡çªæ•´åˆ", domain: "INFLUENCING", icon: "ğŸ­", dimension: "conflict_integration" },
            "T12": { name: "è²¬ä»»èˆ‡ç•¶è²¬", domain: "EXECUTING", icon: "ğŸ’¼", dimension: "responsibility_accountability" }
        };

        // ç¶­åº¦åç¨± â†’ æ‰å¹¹ ID æ˜ å°„
        const DIMENSION_TO_TALENT = {
            "structured_execution": "T1",
            "quality_perfectionism": "T2",
            "exploration_innovation": "T3",
            "analytical_insight": "T4",
            "influence_advocacy": "T5",
            "collaboration_harmony": "T6",
            "customer_orientation": "T7",
            "learning_growth": "T8",
            "discipline_trust": "T9",
            "pressure_regulation": "T10",
            "conflict_integration": "T11",
            "responsibility_accountability": "T12"
        };

        // åœ˜éšŠåŸå‹å®šç¾©
        const ARCHETYPES = {
            ARCHITECT: {
                name: "ç³»çµ±å»ºæ§‹è€…",
                temperament: "ç†æ€§è€… (Rational)",
                icon: "ğŸ—ï¸",
                color: "var(--architect)",
                description: "å¤©ç”Ÿçš„ç³»çµ±æ€è€ƒè€…èˆ‡å»ºæ§‹è€…ï¼Œæ“…é•·å°‡è¤‡é›œçš„è³‡è¨Šè½‰åŒ–ç‚ºæ¸…æ™°çš„è—åœ–èˆ‡é«˜æ•ˆçš„æµç¨‹ã€‚æ³¨é‡é‚è¼¯ã€æ•ˆç‡èˆ‡é•·æœŸè¦åŠƒã€‚",
                primary_talents: ["T4", "T1"],
                secondary_talents: ["T3", "T8", "T12"],
                contribution: "å°‡æŠ½è±¡ç­–ç•¥è½‰åŒ–ç‚ºå…·é«”ã€å¯åŸ·è¡Œçš„æ­¥é©Ÿï¼Œä¸¦è¨­è¨ˆé«˜æ•ˆçš„ç³»çµ±èˆ‡æµç¨‹ã€‚",
                style: "åå¥½åŸºæ–¼æ•¸æ“šå’Œé‚è¼¯çš„æºé€šï¼Œå°ˆæ³¨æ–¼è§£æ±ºå•é¡Œçš„æ ¹æœ¬åŸå› ã€‚",
                blind_spot: "å¯èƒ½å› éæ–¼å°ˆæ³¨å®è§€ç­–ç•¥ï¼Œè€Œå¿½ç•¥åŸ·è¡Œéç¨‹ä¸­çš„äººéš›å‹•æ…‹èˆ‡ç´°ç¯€ã€‚",
                complements: ["GUARDIAN", "IDEALIST"],
                variants: {
                    EXECUTING: {
                        name: "æµç¨‹å°å‘",
                        icon: "ğŸ—ï¸",
                        description: "é‡è¦–æµç¨‹èˆ‡ç³»çµ±çš„åŸ·è¡Œå‹å»ºæ§‹è€…ï¼Œæ“…é•·å°‡ç›®æ¨™æ‹†è§£ç‚ºå¯åŸ·è¡Œæ­¥é©Ÿï¼Œå»ºç«‹é«˜æ•ˆçš„å·¥ä½œæµç¨‹ã€‚",
                        careers: ["å°ˆæ¡ˆç¶“ç†", "æµç¨‹å·¥ç¨‹å¸«", "å“è³ªç¶“ç†", "ERP é¡§å•"],
                        strength: "å°‡è¤‡é›œä»»å‹™åˆ†è§£ç‚ºæ¸…æ™°æ­¥é©Ÿï¼Œç¢ºä¿æ¯å€‹ç’°ç¯€é«˜æ•ˆé‹ä½œ"
                    },
                    STRATEGIC_THINKING: {
                        name: "ç­–ç•¥å°å‘",
                        icon: "ğŸ§ ",
                        description: "é‡è¦–ç­–ç•¥èˆ‡å‰µæ–°çš„æ€è€ƒå‹å»ºæ§‹è€…ï¼Œæ“…é•·åˆ†æè¤‡é›œå•é¡Œï¼Œè¨­è¨ˆå‰µæ–°çš„è§£æ±ºæ–¹æ¡ˆèˆ‡ç³»çµ±æ¶æ§‹ã€‚",
                        careers: ["ç­–ç•¥é¡§å•", "ç”¢å“ç¶“ç†", "ç³»çµ±æ¶æ§‹å¸«", "æŠ€è¡“ç¸½ç›£"],
                        strength: "æ´å¯Ÿæœ¬è³ªå•é¡Œï¼Œè¨­è¨ˆå…¼å…·å‰µæ–°æ€§èˆ‡å¯è¡Œæ€§çš„ç³»çµ±æ–¹æ¡ˆ"
                    }
                }
            },
            GUARDIAN: {
                name: "çµ„ç¹”å®ˆè­·è€…",
                temperament: "å®ˆè­·è€… (Guardian)",
                icon: "ğŸ›¡ï¸",
                color: "var(--guardian)",
                description: "å¯é çš„åŸ·è¡Œè€…èˆ‡ç¶­è­·è€…ï¼Œæ“…é•·å»ºç«‹å’Œç¶­è­·ç©©å®šçš„ç³»çµ±ï¼Œä¸¦ç¢ºä¿ä»»å‹™æŒ‰æ™‚ã€æŒ‰è³ªå®Œæˆã€‚æ³¨é‡è²¬ä»»ã€ç´€å¾‹èˆ‡å“è³ªã€‚",
                primary_talents: ["T12", "T9"],
                secondary_talents: ["T2", "T1", "T6"],
                contribution: "ç¢ºä¿è¨ˆåŠƒçš„ç©©å®šè½åœ°èˆ‡é«˜è³ªé‡äº¤ä»˜ï¼Œæ˜¯åœ˜éšŠä¸­æœ€å¯é çš„å¾Œç›¾ã€‚",
                style: "æºé€šå‹™å¯¦ã€ç›´æ¥ï¼Œé‡è¦–æ‰¿è«¾èˆ‡æˆªæ­¢æ—¥æœŸï¼Œæ˜¯åœ˜éšŠçš„ç©©å®šåŠ‘ã€‚",
                blind_spot: "å¯èƒ½å°çªç™¼è®ŠåŒ–æˆ–è¦å‰‡å¤–çš„å‰µæ–°æŒä¿ç•™æ…‹åº¦ï¼Œæœ‰æ™‚æœƒç¼ºä¹éˆæ´»æ€§ã€‚",
                complements: ["ARCHITECT", "ARTISAN"],
                variants: {
                    EXECUTING: {
                        name: "å“è³ªå°å‘",
                        icon: "ğŸ›¡ï¸",
                        description: "é‡è¦–å“è³ªèˆ‡äº¤ä»˜çš„åŸ·è¡Œå‹å®ˆè­·è€…ï¼Œæ“…é•·ç¢ºä¿æ¯å€‹ç´°ç¯€ç¬¦åˆæ¨™æº–ï¼ŒæŒ‰æ™‚å®Œæˆä»»å‹™ã€‚",
                        careers: ["å“è³ªç¶“ç†", "è¡Œæ”¿ä¸»ç®¡", "åˆè¦å°ˆå“¡", "ç‡Ÿé‹ç¶“ç†"],
                        strength: "å»ºç«‹å®Œå–„çš„å“è³ªæª¢æ ¸æ©Ÿåˆ¶ï¼Œç¢ºä¿ç©©å®šé«˜è³ªé‡çš„ç”¢å‡º"
                    },
                    RELATIONSHIP_BUILDING: {
                        name: "ä¿¡ä»»å°å‘",
                        icon: "ğŸ¤",
                        description: "é‡è¦–ä¿¡ä»»èˆ‡é—œä¿‚çš„å”ä½œå‹å®ˆè­·è€…ï¼Œæ“…é•·ç¶­è­·åœ˜éšŠå’Œè«§ï¼Œå»ºç«‹å¯é çš„å”ä½œç¶²çµ¡ã€‚",
                        careers: ["HR å¤¥ä¼´", "åœ˜éšŠå”èª¿è€…", "å®¢æˆ¶æˆåŠŸç¶“ç†", "ç¤¾ç¾¤ç¶“ç†"],
                        strength: "æˆç‚ºåœ˜éšŠçš„å¯é å¾Œç›¾ï¼Œç¶­è­·ä¿¡ä»»èˆ‡ç©©å®šçš„å”ä½œé—œä¿‚"
                    }
                }
            },
            IDEALIST: {
                name: "äººæ–‡é—œæ‡·å®¶",
                temperament: "ç†æƒ³ä¸»ç¾©è€… (Idealist)",
                icon: "â¤ï¸",
                color: "var(--idealist)",
                description: "ä»¥äººç‚ºæœ¬çš„æºé€šè€…èˆ‡è³¦èƒ½è€…ï¼Œæ“…é•·ç†è§£ä»–äººã€å»ºç«‹é—œä¿‚ä¸¦æ¿€å‹µåœ˜éšŠã€‚æ³¨é‡å’Œè«§ã€æˆé•·èˆ‡å…±åŒåƒ¹å€¼ã€‚",
                primary_talents: ["T6", "T8"],
                secondary_talents: ["T5", "T11", "T7"],
                contribution: "å‡èšåœ˜éšŠå…±è­˜ï¼Œæ¿€ç™¼æˆå“¡æ½›åŠ›ï¼Œå‰µé€ ä¸€å€‹ç©æ¥µã€äº’ä¿¡çš„å”ä½œæ°›åœã€‚",
                style: "å¯Œæœ‰åŒç†å¿ƒï¼Œå–„æ–¼å‚¾è½èˆ‡é¼“èˆä»–äººï¼Œæ˜¯åœ˜éšŠé—œä¿‚çš„å‚¬åŒ–åŠ‘ã€‚",
                blind_spot: "åœ¨è¿½æ±‚å’Œè«§çš„éç¨‹ä¸­ï¼Œæœ‰æ™‚å¯èƒ½è¿´é¿å¿…è¦çš„è¡çªèˆ‡è‰±é›£çš„æ±ºå®šã€‚",
                complements: ["ARCHITECT", "GUARDIAN"],
                variants: {
                    RELATIONSHIP_BUILDING: {
                        name: "å’Œè«§å°å‘",
                        icon: "â¤ï¸",
                        description: "é‡è¦–å’Œè«§èˆ‡è³¦èƒ½çš„é—œä¿‚å‹ç†æƒ³å®¶ï¼Œæ“…é•·å»ºç«‹ä¿¡ä»»æ°›åœï¼Œæ¿€ç™¼åœ˜éšŠæ½›åŠ›ã€‚",
                        careers: ["HR å¤¥ä¼´", "çµ„ç¹”ç™¼å±•é¡§å•", "åœ˜éšŠæ•™ç·´", "å“¡å·¥é—œä¿‚å°ˆå“¡"],
                        strength: "å‰µé€ ç©æ¥µçš„åœ˜éšŠæ–‡åŒ–ï¼Œè®“æ¯å€‹æˆå“¡éƒ½èƒ½ç™¼æ®æ½›åŠ›"
                    },
                    STRATEGIC_THINKING: {
                        name: "æˆé•·å°å‘",
                        icon: "ğŸ“š",
                        description: "é‡è¦–å­¸ç¿’èˆ‡æˆé•·çš„æ•™è‚²å‹ç†æƒ³å®¶ï¼Œæ“…é•·è¨­è¨ˆåŸ¹è¨“é«”ç³»ï¼Œä¿ƒé€²å€‹äººèˆ‡çµ„ç¹”ç™¼å±•ã€‚",
                        careers: ["ä¼æ¥­åŸ¹è¨“å¸«", "æ•™è‚²å‰µæ¥­å®¶", "å­¸ç¿’ç™¼å±•ç¶“ç†", "è¬›å¸«"],
                        strength: "å»ºç«‹ç³»çµ±åŒ–çš„å­¸ç¿’è·¯å¾‘ï¼Œå¹«åŠ©ä»–äººå¯¦ç¾æˆé•·ç›®æ¨™"
                    },
                    INFLUENCING: {
                        name: "å½±éŸ¿å°å‘",
                        icon: "ğŸ’¡",
                        description: "é‡è¦–å½±éŸ¿èˆ‡å€¡è­°çš„æ¨å»£å‹ç†æƒ³å®¶ï¼Œæ“…é•·å‚³æ’­ç†å¿µï¼Œå‡èšå…±è­˜ï¼Œæ¨å‹•è®Šé©ã€‚",
                        careers: ["è®Šé©ç®¡ç†é¡§å•", "DEI å°ˆå“¡", "ç¤¾æœƒä¼æ¥­å®¶", "ä¼æ¥­æ–‡åŒ–ä¸»ç®¡"],
                        strength: "ä»¥å¯Œæœ‰æ„ŸæŸ“åŠ›çš„æ–¹å¼å‚³æ’­åƒ¹å€¼è§€ï¼Œæ¿€ç™¼é›†é«”è¡Œå‹•"
                    }
                }
            },
            ARTISAN: {
                name: "æ¨å»£å¯¦è¸å®¶",
                temperament: "å·¥åŒ  (Artisan)",
                icon: "ğŸš€",
                color: "var(--artisan)",
                description: "å……æ»¿æ´»åŠ›çš„è¡Œå‹•æ´¾èˆ‡é€£çµè€…ï¼Œæ“…é•·å°‡æƒ³æ³•ä»˜è«¸å¯¦è¸ï¼Œä¸¦åœ¨èˆ‡äººäº’å‹•ä¸­ç²å¾—èƒ½é‡ã€‚æ³¨é‡çµæœã€æ•ˆç‡èˆ‡äººéš›é—œä¿‚ã€‚",
                primary_talents: ["T5", "T10"],
                secondary_talents: ["T3", "T7", "T11"],
                contribution: "æ¨å‹•é …ç›®é€²å±•ï¼Œéˆæ´»æ‡‰å°æŒ‘æˆ°ï¼Œä¸¦å°‡åœ˜éšŠæˆæœå‘å¤–æ¨å»£ã€‚",
                style: "æºé€šç›´æ¥ã€å¯Œæœ‰æ„ŸæŸ“åŠ›ï¼Œå–„æ–¼æ‡‰å°å±æ©Ÿï¼Œæ˜¯åœ˜éšŠçš„ã€Œæ•‘ç«éšŠå“¡ã€ã€‚",
                blind_spot: "å¯èƒ½å› è¿½æ±‚å¿«é€Ÿè¡Œå‹•è€Œå¿½ç•¥é•·æœŸè¦åŠƒï¼Œæœ‰æ™‚ç¼ºä¹è€å¿ƒèˆ‡ç´°ç¯€è€ƒé‡ã€‚",
                complements: ["GUARDIAN", "ARCHITECT"],
                variants: {
                    INFLUENCING: {
                        name: "æ¨å»£å°å‘",
                        icon: "ğŸš€",
                        description: "é‡è¦–å½±éŸ¿èˆ‡æ¨å»£çš„è¡Œå‹•å‹å¯¦è¸å®¶ï¼Œæ“…é•·å°‡æˆæœå‘å¤–æ¨å»£ï¼Œå»ºç«‹å»£æ³›çš„å½±éŸ¿åŠ›ã€‚",
                        careers: ["æ¥­å‹™ä¸»ç®¡", "BD ç¶“ç†", "å¸‚å ´æ¨å»£å°ˆå“¡", "å…¬é—œç¶“ç†"],
                        strength: "å¿«é€Ÿå»ºç«‹äººè„ˆï¼Œå°‡æƒ³æ³•è½‰åŒ–ç‚ºå¯¦éš›è¡Œå‹•èˆ‡æˆæœ"
                    },
                    RELATIONSHIP_BUILDING: {
                        name: "æ‡‰è®Šå°å‘",
                        icon: "âš¡",
                        description: "é‡è¦–æ‡‰è®Šèˆ‡å±æ©Ÿè™•ç†çš„éˆæ´»å‹å¯¦è¸å®¶ï¼Œæ“…é•·åœ¨å£“åŠ›ä¸‹ä¿æŒå†·éœï¼Œå¿«é€Ÿè§£æ±ºå•é¡Œã€‚",
                        careers: ["å±æ©Ÿè™•ç†å°ˆå“¡", "å®¢æˆ¶æˆåŠŸç¶“ç†", "ç¾å ´ç¶“ç†", "å°ˆæ¡ˆæ•‘ç«éšŠ"],
                        strength: "åœ¨é«˜å£“ç’°å¢ƒä¸­å¿«é€Ÿæ±ºç­–ï¼Œéˆæ´»æ‡‰å°çªç™¼ç‹€æ³"
                    },
                    STRATEGIC_THINKING: {
                        name: "å‰µæ–°å°å‘",
                        icon: "ğŸ’¡",
                        description: "é‡è¦–å‰µæ–°èˆ‡å¯¦é©—çš„æ¢ç´¢å‹å¯¦è¸å®¶ï¼Œæ“…é•·å˜—è©¦æ–°æ–¹æ³•ï¼Œå¿«é€Ÿé©—è­‰æƒ³æ³•ã€‚",
                        careers: ["ç”¢å“å‰µæ–°ç¶“ç†", "å‰µæ¥­å®¶", "å¢é•·é§­å®¢", "å¯¦é©—å°ˆæ¡ˆè² è²¬äºº"],
                        strength: "å‹‡æ–¼å˜—è©¦å‰µæ–°æ–¹æ³•ï¼Œå¿«é€Ÿå°‡æƒ³æ³•è½åœ°ä¸¦è¿­ä»£å„ªåŒ–"
                    }
                }
            }
        };

        // é é¢åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', () => {
            const sessionId = new URLSearchParams(window.location.search).get('session');
            if (sessionId) {
                loadDetailedReport(sessionId);
            } else {
                showError('æ‰¾ä¸åˆ°è©•æ¸¬æœƒè©± ID');
            }
        });

        // è¼‰å…¥å ±å‘Šæ•¸æ“š
        async function loadDetailedReport(sessionId) {
            try {
                const [resultsResponse, matrixResponse] = await Promise.all([
                    fetch(`${apiBase}/api/assessment/results/${sessionId}`),
                    fetch(`${apiBase}/assessment/team_fitness_matrix.json`)
                ]);

                if (!resultsResponse.ok) throw new Error(`HTTP ${resultsResponse.status} for results`);
                if (!matrixResponse.ok) throw new Error(`HTTP ${matrixResponse.status} for matrix`);

                const data = await resultsResponse.json();
                const matrixData = await matrixResponse.json();
                
                updateReportContent(data, matrixData);
            } catch (error) {
                showError('è¼‰å…¥å ±å‘Šå¤±æ•—: ' + error.message);
            }
        }

        // æ›´æ–°å ±å‘Šå…§å®¹
        function updateReportContent(data, matrixData) {
            const scores = data.scores || {};

            const talentScores = Object.entries(scores)
                .map(([key, score]) => {
                    // Extract dimension name from key (format: t{number}_{dimension_name})
                    const match = key.match(/^t\d+_(.+)$/);
                    if (!match) return null;

                    const dimensionName = match[1];
                    const talentId = DIMENSION_TO_TALENT[dimensionName];

                    if (!talentId) {
                        console.warn(`Unknown dimension: ${dimensionName}`);
                        return null;
                    }

                    const definition = TALENT_DEFINITIONS[talentId];
                    return definition ? { ...definition, id: talentId, score: score } : null;
                })
                .filter(Boolean)
                .sort((a, b) => b.score - a.score);

            if (talentScores.length === 0) {
                showError('è©•æ¸¬åˆ†æ•¸ç„¡æ•ˆ');
                return;
            }

            const teamProfile = calculateTeamProfile(talentScores);
            const primaryDomain = getPrimaryDomain(talentScores);
            const archetypeVariant = getArchetypeVariant(teamProfile.primaryArchetype, primaryDomain);

            renderDomainScores(talentScores);
            renderTeamCompass(teamProfile.archetypeScores);
            renderArchetypeDashboard(archetypeVariant, primaryDomain);
            renderTeamComposition(teamProfile.primaryArchetype);
            renderTeamFitnessMatrix(teamProfile.primaryArchetype, matrixData.matrix_data);
        }

        // è¨ˆç®—åœ˜éšŠç•«åƒ
        function calculateTeamProfile(talentScores) {
            const top6Talents = talentScores.slice(0, 6).map(t => t.id);

            let archetypeScores = {};
            for (const key in ARCHETYPES) {
                archetypeScores[key] = { score: 0, archetype: ARCHETYPES[key] };
                
                // ä¸»å°æ‰å¹¹è¨ˆåˆ† (Top 4)
                ARCHETYPES[key].primary_talents.forEach(talentId => {
                    if (top6Talents.slice(0, 4).includes(talentId)) {
                        archetypeScores[key].score += 2;
                    }
                });
                
                // è¼”åŠ©æ‰å¹¹è¨ˆåˆ† (Top 6)
                ARCHETYPES[key].secondary_talents.forEach(talentId => {
                    if (top6Talents.includes(talentId)) {
                        archetypeScores[key].score += 1;
                    }
                });
            }
            
            const sortedArchetypes = Object.values(archetypeScores).sort((a, b) => b.score - a.score);
            const primaryArchetype = sortedArchetypes[0].archetype;
            const primaryArchetypeKey = Object.keys(ARCHETYPES).find(key => ARCHETYPES[key].name === primaryArchetype.name);

            return { primaryArchetype, archetypeScores, primaryArchetypeKey };
        }

        // è¨ˆç®—ä¸»å°é ˜åŸŸ
        function getPrimaryDomain(talentScores) {
            const domainTotals = { EXECUTING: 0, INFLUENCING: 0, RELATIONSHIP_BUILDING: 0, STRATEGIC_THINKING: 0 };
            const domainCounts = { EXECUTING: 0, INFLUENCING: 0, RELATIONSHIP_BUILDING: 0, STRATEGIC_THINKING: 0 };

            talentScores.forEach(talent => {
                if (domainTotals.hasOwnProperty(talent.domain)) {
                    domainTotals[talent.domain] += talent.score;
                    domainCounts[talent.domain]++;
                }
            });

            const domainAverages = {};
            for (const domain in domainTotals) {
                domainAverages[domain] = domainTotals[domain] / (domainCounts[domain] || 1);
            }

            return Object.keys(domainAverages).reduce((a, b) =>
                domainAverages[a] > domainAverages[b] ? a : b
            );
        }

        // ç²å–åŸå‹å­é¡å‹
        function getArchetypeVariant(archetype, primaryDomain) {
            const variants = archetype.variants;

            if (!variants) {
                // æ²’æœ‰å­é¡å‹ï¼Œè¿”å›åŸºç¤åŸå‹
                return {
                    ...archetype,
                    variantName: null,
                    variantDomain: null,
                    careers: [],
                    strength: archetype.contribution
                };
            }

            // æ ¹æ“šä¸»å°é ˜åŸŸé¸æ“‡å­é¡å‹
            const variant = variants[primaryDomain];

            if (variant) {
                return {
                    ...archetype,
                    variantName: variant.name,
                    variantIcon: variant.icon,
                    variantDescription: variant.description,
                    variantDomain: primaryDomain,
                    careers: variant.careers,
                    strength: variant.strength
                };
            }

            // å¦‚æœæ²’æœ‰å®Œå…¨åŒ¹é…çš„å­é¡å‹ï¼Œä½¿ç”¨ç¬¬ä¸€å€‹å¯ç”¨çš„
            const fallbackDomain = Object.keys(variants)[0];
            const fallbackVariant = variants[fallbackDomain];

            return {
                ...archetype,
                variantName: fallbackVariant.name,
                variantIcon: fallbackVariant.icon,
                variantDescription: fallbackVariant.description,
                variantDomain: fallbackDomain,
                careers: fallbackVariant.careers,
                strength: fallbackVariant.strength
            };
        }

        // æ¸²æŸ“é ˜åŸŸåˆ†æ•¸
        function renderDomainScores(talentScores) {
            const container = document.getElementById('domain-scores');
            const domainTotals = { EXECUTING: 0, INFLUENCING: 0, RELATIONSHIP_BUILDING: 0, STRATEGIC_THINKING: 0 };
            const domainCounts = { EXECUTING: 0, INFLUENCING: 0, RELATIONSHIP_BUILDING: 0, STRATEGIC_THINKING: 0 };

            talentScores.forEach(talent => {
                if (domainTotals.hasOwnProperty(talent.domain)) {
                    domainTotals[talent.domain] += talent.score;
                    domainCounts[talent.domain]++;
                }
            });

            const domainAverages = {};
            let totalScore = 0;
            for(const domain in domainTotals) {
                domainAverages[domain] = domainTotals[domain] / (domainCounts[domain] || 1);
                totalScore += domainAverages[domain];
            }
            if (totalScore === 0) totalScore = 1;

            const domainPercentages = {};
            for(const domain in domainAverages) {
                domainPercentages[domain] = Math.round((domainAverages[domain] / totalScore) * 100);
            }
            
            const domainInfo = {
                EXECUTING: { name: "åŸ·è¡ŒåŠ›", color: "var(--executing)" },
                INFLUENCING: { name: "å½±éŸ¿åŠ›", color: "var(--influencing)" },
                RELATIONSHIP_BUILDING: { name: "é—œä¿‚å»ºç«‹", color: "var(--relationship)" },
                STRATEGIC_THINKING: { name: "æˆ°ç•¥æ€ç¶­", color: "var(--strategic)" }
            };

            container.innerHTML = Object.entries(domainPercentages).map(([domain, percentage]) => `
                <li>
                    <span class="domain-name">
                        <span class="domain-color-dot" style="background-color: ${domainInfo[domain].color};"></span>
                        ${domainInfo[domain].name}
                    </span>
                    <div class="domain-bar-container">
                        <div class="domain-bar" style="width: ${percentage}%; background-color: ${domainInfo[domain].color};"></div>
                    </div>
                    <span class="domain-percentage">${percentage}%</span>
                </li>
            `).join('');
        }

        // æ¸²æŸ“åœ˜éšŠç¾…ç›¤
        function renderTeamCompass(archetypeScores) {
             const container = document.getElementById('compass-chart');
             const primaryArchetype = Object.values(archetypeScores).sort((a,b) => b.score - a.score)[0].archetype;
 
             // å››åŸå‹é †åºèˆ‡é¡è‰²
             const order = ["ARCHITECT", "GUARDIAN", "IDEALIST", "ARTISAN"];
             const maxScore = Math.max(...Object.values(archetypeScores).map(s => s.score), 5);
 
            const cardsHTML = order.map(key => {
                const archetype = ARCHETYPES[key];
                const score = archetypeScores[key].score;
                const percentage = Math.round((score / maxScore) * 100);
                const isPrimary = archetype.name === primaryArchetype.name;

                return `
                    <div class="archetype-card ${isPrimary ? 'primary' : ''}" style="border-color:${archetype.color};">
                        <div class="archetype-card-header">
                            <div class="archetype-card-icon" style="background:${archetype.color};">
                                ${archetype.icon}
                            </div>
                            <div class="archetype-card-score" style="color:${archetype.color};">
                                ${score}
                            </div>
                        </div>
                        <h4 class="archetype-card-title">${archetype.name}</h4>
                        <div class="archetype-card-bar">
                            <div class="archetype-card-bar-fill" style="width:${percentage}%;background:${archetype.color};"></div>
                        </div>
                        <p class="archetype-card-desc">${archetype.temperament}</p>
                        ${isPrimary ? '<div class="archetype-card-badge">ä¸»å°åŸå‹</div>' : ''}
                    </div>
                `;
            }).join('');

            container.innerHTML = `
                <div class="archetype-cards-grid">
                    ${cardsHTML}
                </div>
            `;
 
             const descriptionContainer = document.getElementById('compass-main-archetype');
             descriptionContainer.innerHTML = `
                 <span class="badge-pill gold">æ‚¨çš„åœ˜éšŠå®šä½</span>
                 <h3>ä¸»å°åŸå‹ï¼š<span style="color:${primaryArchetype.color}">${primaryArchetype.name}</span></h3>
                 <p>${primaryArchetype.description}</p>
                 <p style="margin-top:1rem;font-size:0.9375rem;color:var(--slate-600);">ğŸ’¡ æ‚¨çš„æ‰å¹¹çµ„åˆé¡¯ç¤ºå‡ºå¼·çƒˆçš„ <strong>${primaryArchetype.temperament}</strong> å‚¾å‘ï¼Œé€™å®šç¾©äº†æ‚¨åœ¨åœ˜éšŠä¸­çš„æ ¸å¿ƒè§’è‰²èˆ‡è²¢ç»æ–¹å¼ã€‚</p>
             `;
         }

        // æ¸²æŸ“åŸå‹å„€è¡¨æ¿
        function renderArchetypeDashboard(archetypeVariant, primaryDomain) {
            const icon = archetypeVariant.variantIcon || archetypeVariant.icon;
            document.getElementById('archetype-icon').textContent = icon;
            document.getElementById('archetype-icon').style.background = archetypeVariant.color;

            // é¡¯ç¤ºåŸå‹åç¨± + å­é¡å‹
            const titleText = archetypeVariant.variantName
                ? `${archetypeVariant.name} - ${archetypeVariant.variantName}`
                : archetypeVariant.name;

            document.getElementById('archetype-title').textContent = titleText;
            document.getElementById('archetype-subtitle').textContent = archetypeVariant.temperament;

            const container = document.getElementById('archetype-dashboard-content');

            // ä½¿ç”¨å­é¡å‹æè¿°æˆ–åŸºç¤æè¿°
            const contributionText = archetypeVariant.variantDescription || archetypeVariant.description;

            container.innerHTML = `
                <div class="info-item" style="border-color: ${archetypeVariant.color};">
                    <h4>â­ æ ¸å¿ƒå„ªå‹¢</h4>
                    <p>${archetypeVariant.strength}</p>
                </div>
                <div class="info-item" style="border-color: ${archetypeVariant.color};">
                    <h4>ğŸ’¬ å”ä½œé¢¨æ ¼</h4>
                    <p>${archetypeVariant.style}</p>
                </div>
                <div class="info-item" style="border-color: var(--warning);">
                    <h4>âš ï¸ æ½›åœ¨ç›²é»</h4>
                    <p>${archetypeVariant.blind_spot}</p>
                </div>
                ${archetypeVariant.careers && archetypeVariant.careers.length > 0 ? `
                <div class="info-item" style="border-color: var(--success); grid-column: 1 / -1;">
                    <h4>ğŸ’¼ é©åˆè·æ¥­</h4>
                    <p>${archetypeVariant.careers.join('ã€')}</p>
                </div>
                ` : ''}
            `;
        }

        // æ¸²æŸ“ç†æƒ³åœ˜éšŠçµ„åˆ
        function renderTeamComposition(primaryArchetype) {
             const container = document.getElementById('team-composition-content');
             container.innerHTML = primaryArchetype.complements.map(archetypeKey => {
                 const archetype = ARCHETYPES[archetypeKey];
                 return `
                     <div class="team-member-card">
                        <div class="member-icon" style="background: linear-gradient(135deg, ${archetype.color}, rgba(255,255,255,0.6));">${archetype.icon}</div>
                        <span class="badge-pill neutral">Complement</span>
                        <h4>æ‚¨éœ€è¦ä¸€ä½ã€Œ${archetype.name}ã€</h4>
                        <p>${archetype.description.split('ã€‚')[0]}ã€‚</p>
                    </div>
                 `;
             }).join('') || '<p>ç„¡æ³•ç”Ÿæˆåœ˜éšŠå»ºè­°ã€‚</p>';
         }

        // æ¸²æŸ“åœ˜éšŠé©é…æ€§é³¥ç°è¡¨
        function renderTeamFitnessMatrix(archetype, matrixData) {
             const container = document.getElementById('team-fitness-matrix-content');
             const archetypeKey = Object.keys(ARCHETYPES).find(key => ARCHETYPES[key].name === archetype.name);
             const data = matrixData[archetypeKey];

             if (!data) {
                 container.innerHTML = '<p>ç„¡æ³•è¼‰å…¥åœ˜éšŠé©é…æ€§åˆ†ææ•¸æ“šã€‚</p>';
                 return;
             }

            const timeline = Object.entries(data.stages).map(([stageKey, stageData], index) => {
                const strengths = stageData.strengths.map(item => `
                    <div class="matrix-card">
                        <h6><span class="matrix-chip">ğŸŸ¢</span>${item.trait}</h6>
                        <p>${item.behavior}</p>
                    </div>
                `).join('');

                const challenges = stageData.challenges.map(item => `
                    <div class="matrix-card challenge">
                        <h6><span class="matrix-chip">ğŸ”´</span>${item.trait}</h6>
                        <p>${item.behavior}</p>
                    </div>
                `).join('');

                return `
                    <div class="matrix-block">
                        <div class="matrix-stage">
                            <span class="matrix-stage-number">${index + 1}</span>
                            <div>
                                <h4 class="matrix-heading">${stageData.stage_name}</h4>
                                <p class="matrix-subtitle">é‡é»èšç„¦ï¼š${stageData.stage_focus}</p>
                            </div>
                        </div>
                        <span class="matrix-stage-pill">${stageData.stage_focus}</span>
                        <div class="matrix-columns">
                            <div>
                                <h6 style="margin:0 0 0.65rem;color:var(--success-green);display:flex;align-items:center;gap:0.4rem;font-size:0.9rem;">å¼·å‹¢è²¢ç»</h6>
                                ${strengths}
                            </div>
                            <div>
                                <h6 style="margin:0 0 0.65rem;color:var(--alert-red);display:flex;align-items:center;gap:0.4rem;font-size:0.9rem;">æ½›åœ¨æŒ‘æˆ°</h6>
                                ${challenges}
                            </div>
                        </div>
                    </div>
                `;
            }).join('');

            container.innerHTML = `
                <div class="matrix-grid">
                    ${timeline}
                </div>
                <div class="section-footnote">ä¾ Tuckman åœ˜éšŠç™¼å±•éšæ®µèˆ‡ Big Five æ€§æ ¼å‚¾å‘äº¤å‰åˆ†æã€‚ä¾åºæª¢è¦–å››éšæ®µï¼Œå¯å”åŠ©æ’ç¨‹å°æ‡‰æ”¯æŒèˆ‡è§’è‰²é…ç½®ã€‚</div>
            `;
         }


        // é¡¯ç¤ºéŒ¯èª¤
        function showError(message) {
            console.error('Report error:', message);
            const container = document.querySelector('.main-container');
            container.innerHTML = `<div class="analysis-card"><p style="color:var(--error); text-align:center;">${message}</p></div>`;
        }

        // è¿”å›å€‹äººå„ªå‹¢å ±å‘Š
        function backToResults() {
            const sessionId = new URLSearchParams(window.location.search).get('session');
            if (sessionId) {
                window.location.href = `results.html?session=${sessionId}`;
            } else {
                window.location.href = 'results.html';
            }
        }

        // åˆ†äº«å ±å‘Š
        function shareReport() {
            if (navigator.share) {
                navigator.share({
                    title: 'æˆ‘çš„åœ˜éšŠå”ä½œæ½›åŠ›åˆ†æå ±å‘Š',
                    text: 'æˆ‘å‰›å®Œæˆäº†å„ªå‹¢å¤©è³¦è©•æ¸¬ï¼Œé€™æ˜¯æˆ‘åœ¨åœ˜éšŠä¸­çš„è§’è‰²å®šä½ï¼',
                    url: window.location.href
                }).catch(console.error);
            } else {
                navigator.clipboard.writeText(window.location.href)
                    .then(() => alert('å ±å‘Šé€£çµå·²è¤‡è£½åˆ°å‰ªè²¼æ¿ï¼'))
                    .catch(() => alert('è¤‡è£½å¤±æ•—ï¼Œè«‹æ‰‹å‹•è¤‡è£½é€£çµã€‚'));
            }
        }
    </script>
</body>
</html>
