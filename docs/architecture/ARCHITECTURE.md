# Gallup å„ªå‹¢æ¸¬é©— - æ¶æ§‹èˆ‡è¨­è¨ˆæ–‡ä»¶

---

**æ–‡ä»¶ç‰ˆæœ¬:** v1.0
**æœ€å¾Œæ›´æ–°:** 2025-09-30
**ä¸»è¦ä½œè€…:** æŠ€è¡“æ¶æ§‹å¸«
**ç‹€æ…‹:** å¯©æ ¸ä¸­ (In Review)

---

## ç›®éŒ„

1. [æ¶æ§‹ç¸½è¦½](#1-æ¶æ§‹ç¸½è¦½)
2. [éœ€æ±‚æ‘˜è¦](#2-éœ€æ±‚æ‘˜è¦)
3. [æŠ€è¡“é¸å‹](#3-æŠ€è¡“é¸å‹)
4. [æ•¸æ“šæ¶æ§‹](#4-æ•¸æ“šæ¶æ§‹)
5. [éƒ¨ç½²æ¶æ§‹](#5-éƒ¨ç½²æ¶æ§‹)

---

## 1. æ¶æ§‹ç¸½è¦½

### 1.1 ç³»çµ±æƒ…å¢ƒ

Gallup å„ªå‹¢æ¸¬é©—ç³»çµ±æ˜¯ä¸€å€‹åŸºæ–¼äººæ ¼è©•ä¼°çš„è·æ¶¯å»ºè­°å·¥å…·ï¼Œå”åŠ©ç”¨æˆ¶é€éæ¨™æº–åŒ–å•å·ç™¼ç¾è‡ªèº«å„ªå‹¢é¢å‘ã€‚

### 1.2 æ¶æ§‹æ¨¡å¼

**é¸å®šæ¨¡å¼:** æ¨¡çµ„åŒ–å–®é«”æ¶æ§‹ (Modular Monolith)

**é¸æ“‡ç†ç”±:**
- MVP éšæ®µéœ€è¦å¿«é€Ÿè¿­ä»£
- åœ˜éšŠè¦æ¨¡å°ï¼Œå¾®æœå‹™ç¶­é‹æˆæœ¬éé«˜
- æ¥­å‹™é‚è¼¯æ¸…æ™°ï¼Œé©åˆæ¨¡çµ„åŒ–è¨­è¨ˆ
- æœªä¾†å¯æ‹†åˆ†ç‚ºå¾®æœå‹™

### 1.3 C4 æ¨¡å‹ - ç³»çµ±æƒ…å¢ƒåœ–

```mermaid
graph TD
    User[æ¸¬é©—ä½¿ç”¨è€…] --> WebApp[Web æ‡‰ç”¨ç¨‹å¼]
    WebApp --> APIServer[FastAPI ä¼ºæœå™¨]
    APIServer --> SQLite[(SQLite è³‡æ–™åº«)]
    APIServer --> PDFGen[PDF å ±å‘Šç”Ÿæˆå™¨]
```

### 1.4 Clean Architecture åˆ†å±¤

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Infrastructure Layer               â”‚
â”‚  (API Routes, Database, PDF)       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Application Layer                  â”‚
â”‚  (Use Cases, Services)             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Domain Layer                       â”‚
â”‚  (Entities, Business Rules)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. éœ€æ±‚æ‘˜è¦

### 2.1 åŠŸèƒ½æ€§éœ€æ±‚

| ID | éœ€æ±‚æè¿° | å„ªå…ˆç´š |
|:---|:---------|:------|
| FR-1 | ç”¨æˆ¶åŒæ„èˆ‡éš±ç§åˆè¦ | P0 |
| FR-2 | Mini-IPIP äººæ ¼é‡è¡¨æ¸¬é©— (20é¡Œ) | P0 |
| FR-3 | äº”å¤§äººæ ¼å‘åº¦è¨ˆåˆ† | P0 |
| FR-4 | 12 å€‹ Gallup å„ªå‹¢é¢å‘æ˜ å°„ | P0 |
| FR-5 | è·ç¼ºæ¨è–¦å¼•æ“ | P1 |
| FR-6 | æ”¹å–„å»ºè­°ç”Ÿæˆ | P1 |
| FR-7 | PDF å ±å‘Šç”Ÿæˆèˆ‡åˆ†äº« | P0 |

### 2.2 éåŠŸèƒ½æ€§éœ€æ±‚

| NFR åˆ†é¡ | å…·é«”éœ€æ±‚ | ç›®æ¨™å€¼ |
|:---------|:---------|:-------|
| **æ€§èƒ½** | æ¸¬é©—å®Œæˆåˆ°å ±å‘Šç”Ÿæˆæ™‚é–“ | < 5 ç§’ |
| **å¯ç”¨æ€§** | ç³»çµ±å¯ç”¨æ€§ | > 99% |
| **å¯æ“´å±•æ€§** | æ”¯æ´ç”¨æˆ¶æ•¸ | 1000+ ä¸¦ç™¼ |
| **å®‰å…¨æ€§** | è³‡æ–™å‚³è¼¸åŠ å¯† | HTTPS/TLS 1.3 |
| **åˆè¦æ€§** | å€‹äººè³‡æ–™ä¿è­· | GDPR åŸºæœ¬åˆè¦ |

---

## 3. æŠ€è¡“é¸å‹

### 3.1 æŠ€è¡“é¸å‹åŸå‰‡

1. **å„ªå…ˆ Python ç”Ÿæ…‹:** åœ˜éšŠç†Ÿæ‚‰ï¼Œé–‹ç™¼æ•ˆç‡é«˜
2. **é¸ç”¨æˆç†Ÿå·¥å…·:** é™ä½æŠ€è¡“é¢¨éšª
3. **æœ¬åœ°å„ªå…ˆ:** MVP éšæ®µé¿å…é›²ç«¯ä¾è³´
4. **è¼•é‡éƒ¨ç½²:** å–®ä¸€å¯åŸ·è¡Œæª”ï¼Œæ˜“æ–¼åˆ†ç™¼

### 3.2 æŠ€è¡“æ£§

| åˆ†é¡ | æŠ€è¡“ | é¸æ“‡ç†ç”± | å‚™é¸æ–¹æ¡ˆ |
|:-----|:-----|:---------|:---------|
| **å¾Œç«¯æ¡†æ¶** | FastAPI | é«˜æ€§èƒ½ç•°æ­¥ã€è‡ªå‹•æ–‡æª” | Flask (åŠŸèƒ½è¼ƒå¼±) |
| **è³‡æ–™åº«** | SQLite | é›¶é…ç½®ã€æª”æ¡ˆå¼ã€åµŒå…¥å¼ | PostgreSQL (éåº¦è¨­è¨ˆ) |
| **ORM** | SQLAlchemy 2.0 | æˆç†Ÿã€é¡å‹å®‰å…¨ | Peewee (ç¤¾ç¾¤è¼ƒå°) |
| **PDF ç”Ÿæˆ** | ReportLab | åŠŸèƒ½å®Œæ•´ã€ä¸­æ–‡æ”¯æ´ | WeasyPrint (CSS ä½ˆå±€è¤‡é›œ) |
| **é©—è­‰** | Pydantic v2 | è‡ªå‹•é©—è­‰ã€FastAPI åŸç”Ÿ | Marshmallow (è¼ƒèˆŠ) |
| **æ¸¬è©¦** | Pytest | æ¨™æº–å·¥å…·ã€fixture å¼·å¤§ | Unittest (åŠŸèƒ½è¼ƒå¼±) |

---

## 4. æ•¸æ“šæ¶æ§‹

### 4.1 æ ¸å¿ƒå¯¦é«”é—œä¿‚åœ–

```mermaid
erDiagram
    AssessmentSession ||--o{ Response : contains
    AssessmentSession ||--|| ScoreResult : produces
    ScoreResult ||--o{ StrengthScore : contains
    Question ||--o{ Response : answered_in

    AssessmentSession {
        string session_id PK
        datetime created_at
        datetime completed_at
        boolean consent_given
    }

    Question {
        int question_id PK
        string text
        string dimension
        int reverse_scored
    }

    Response {
        int response_id PK
        string session_id FK
        int question_id FK
        int score
    }

    ScoreResult {
        int result_id PK
        string session_id FK
        json dimension_scores
        datetime calculated_at
    }

    StrengthScore {
        int strength_id PK
        int result_id FK
        string strength_name
        float score
        int rank
    }
```

### 4.2 è³‡æ–™ä¸€è‡´æ€§ç­–ç•¥

- **å¼·ä¸€è‡´æ€§:** æ¸¬é©—çµæœè¨ˆç®—ä½¿ç”¨ ACID äº‹å‹™
- **æœ€çµ‚ä¸€è‡´æ€§:** PDF å ±å‘Šç•°æ­¥ç”Ÿæˆï¼ˆæœªä¾†å„ªåŒ–ï¼‰

### 4.3 è³‡æ–™ç”Ÿå‘½é€±æœŸ

| è³‡æ–™é¡å‹ | åˆ†é¡ | ä¿ç•™æœŸé™ | åŠ å¯†ç­–ç•¥ |
|:---------|:-----|:---------|:---------|
| å•å·å›ç­” | å€‹äººè³‡æ–™ | 30å¤© | SQLite encryption extension |
| åˆ†æçµæœ | åŒ¿åçµ±è¨ˆ | æ°¸ä¹… | N/A |
| åˆ†äº«é€£çµ | æš«æ™‚æ€§ | 7å¤© | Token-based |

---

## 5. éƒ¨ç½²æ¶æ§‹

### 5.1 éƒ¨ç½²è¦–åœ–

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Local Development              â”‚
â”‚  â€¢ uvicorn --reload             â”‚
â”‚  â€¢ SQLite file-based DB         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“ (Docker build)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Production Container           â”‚
â”‚  â€¢ Gunicorn + Uvicorn workers   â”‚
â”‚  â€¢ Volume-mounted SQLite        â”‚
â”‚  â€¢ Nginx reverse proxy          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 ç’°å¢ƒç­–ç•¥

| ç’°å¢ƒ | ç”¨é€” | è³‡æ–™åº« | é…ç½® |
|:-----|:-----|:-------|:-----|
| Development | æœ¬åœ°é–‹ç™¼ | `dev.db` | `.env.dev` |
| Testing | CI/CD | In-memory | `.env.test` |
| Production | æ­£å¼ç’°å¢ƒ | `prod.db` (backup) | `.env.prod` |

### 5.3 æˆæœ¬æ•ˆç›Šåˆ†æ

**MVP éšæ®µæˆæœ¬ï¼ˆæœˆï¼‰:**
- é›²ç«¯è™›æ“¬æ©Ÿ: $5-10 (Digital Ocean Droplet)
- ç¶²åŸŸ + SSL: $1-2
- ç¸½è¨ˆ: < $15/æœˆ

**å„ªåŒ–ç­–ç•¥:**
- ä½¿ç”¨ SQLite é¿å…è³‡æ–™åº«è¨—ç®¡è²»ç”¨
- éœæ…‹è³‡æº CDN åŒ–ï¼ˆæœªä¾†ï¼‰
- å®¹å™¨åŒ–éƒ¨ç½²ï¼Œæ˜“æ–¼é·ç§»

---

## 6. é¢¨éšªèˆ‡ç·©è§£

| é¢¨éšª | å¯èƒ½æ€§ | å½±éŸ¿ | ç·©è§£ç­–ç•¥ |
|:-----|:-------|:-----|:---------|
| SQLite ä¸¦ç™¼é™åˆ¶ | ä¸­ | ä¸­ | ä½¿ç”¨ WAL æ¨¡å¼ï¼Œè€ƒæ…® PostgreSQL é·ç§»è·¯å¾‘ |
| å–®é»æ•…éšœ | é«˜ | é«˜ | å®šæœŸå‚™ä»½ï¼Œå¯¦ä½œå¥åº·æª¢æŸ¥ |
| PDF ç”Ÿæˆé˜»å¡ | ä¸­ | ä½ | ç•°æ­¥ä»»å‹™éšŠåˆ—ï¼ˆPhase 2ï¼‰ |

---

## 7. æ¶æ§‹æ¼”é€²è·¯ç·šåœ–

### Phase 1: MVP (ç•¶å‰)
- âœ… åŸºç¤æ¶æ§‹å»ºç«‹
- ğŸ”„ æ ¸å¿ƒåŠŸèƒ½é–‹ç™¼
- â³ æ¸¬è©¦èˆ‡æ–‡æª”

### Phase 2: å„ªåŒ– (3-6å€‹æœˆ)
- ç•°æ­¥å ±å‘Šç”Ÿæˆ
- Redis å¿«å–å±¤
- ç›£æ§èˆ‡å‘Šè­¦

### Phase 3: æ“´å±• (6-12å€‹æœˆ)
- PostgreSQL é·ç§»
- å¾®æœå‹™æ‹†åˆ†ï¼ˆé¸æ“‡æ€§ï¼‰
- å¤šç§Ÿæˆ¶æ”¯æ´

---

**æ¶æ§‹å¯©æ ¸:** å¾…åœ˜éšŠ review
**ç›¸é—œæ–‡æª”:** [å°ˆæ¡ˆçµæ§‹æŒ‡å—](../structure_guide.md), [API è¦æ ¼](../api/api_specification.md)